# Glance Service - External feeds dashboard with Homepage iframe integration
# Unified interface for external feeds (RSS, Reddit, GitHub) and internal services

services:
  glance:
    image: glanceapp/glance:latest
    container_name: co-glance-service
    restart: unless-stopped
    ports:
      - "8092:8080"
    volumes:
      - ./configs:/app/config
      - /var/run/docker.sock:/var/run/docker.sock:ro
    labels:
      glance.name: "Glance"
      glance.icon: "si:glance"
      glance.url: "https://glance.${PRIMARY_DOMAIN}"
      glance.category: "dashboard"
      glance.description: "Multi-page monitoring dashboard"
    environment:
      - HOMEPAGE_INTERNAL_URL=http://${USER_PREFIX}-homepage-service:3000
      - PRIMARY_DOMAIN=${PRIMARY_DOMAIN}
      # RSS feed environment variables for dynamic configuration
      - RSS_FEED_TECH_NEWS=${RSS_FEED_TECH_NEWS:-}
      - RSS_FEED_HOMELAB=${RSS_FEED_HOMELAB:-}
      - RSS_FEED_SELFHOSTED=${RSS_FEED_SELFHOSTED:-}
      - RSS_FEED_KUBERNETES=${RSS_FEED_KUBERNETES:-}
      - RSS_FEED_DOCKER=${RSS_FEED_DOCKER:-}
      - RSS_FEED_AI_NEWS=${RSS_FEED_AI_NEWS:-}
    networks:
      - app-network
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8080"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    depends_on:
      - homepage

networks:
  app-network:
    name: ${COMPOSE_PROJECT_NAME}_app-network