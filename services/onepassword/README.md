# 1Password Connect Server Service

This directory contains the 1Password Connect Server configuration and related files for the Carian Observatory infrastructure.

## Directory Structure

```
services/onepassword/
├── README.md                           # This file
├── docker-compose.yml                  # Connect Server service definition
├── 1password-credentials.json          # Connect Server credentials (generated)
└── docs/
    └── 1PASSWORD_CONNECT_SERVER_SETUP.md  # Complete setup guide
```

## Quick Reference

### Generate Credentials
```bash
# From project root
op connect server create "Athena Core Connect Server" --vaults "API,Elevenlabs Voice IDs,SSL,Webhooks"
mv 1password-credentials.json services/onepassword/
```

### Start Service
```bash
# From project root
./scripts/manage-connect-server.sh start
```

### Generate Access Token
```bash
# From project root
./scripts/manage-connect-server.sh token create
```

## Files

### `docker-compose.yml`
Docker Compose service definition with two containers:
- `onepassword-connect-sync` - Synchronizes with 1Password.com
- `onepassword-connect-api` - Provides REST API access

### `1password-credentials.json` 
**IMPORTANT**: This file contains encrypted credentials for the Connect Server. 
- Generated by `op connect server create` command
- Required for Connect Server startup
- Automatically gitignored for security

### `docs/1PASSWORD_CONNECT_SERVER_SETUP.md`
Comprehensive setup and configuration guide covering:
- Prerequisites and requirements
- Step-by-step setup instructions
- Security considerations
- Troubleshooting guide
- Advanced configuration options

## Integration

This service is included in the main Docker Compose stack via:
```yaml
# docker-compose.yml (project root)
include:
  - path: services/onepassword/docker-compose.yml
```

## Security Notes

- The Connect Server binds only to localhost (127.0.0.1:8090)
- All credentials are encrypted and stored securely
- Access tokens are required for API authentication
- Internal networks isolate sync operations

## Management Scripts

All management is handled via scripts in the project root:
- `./scripts/manage-connect-server.sh` - Service lifecycle management
- `./scripts/connect-api.sh` - API client operations
- `./scripts/deploy-api-keys.sh` - Secret deployment (with Connect Server integration)

For detailed setup instructions, see [docs/1PASSWORD_CONNECT_SERVER_SETUP.md](docs/1PASSWORD_CONNECT_SERVER_SETUP.md).